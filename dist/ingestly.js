!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.r(t);var i,a=function(e,t){var n=new XMLHttpRequest;return"function"==typeof t&&(n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var e;try{e=JSON.parse(n.response)}catch(e){return e}t.call(null,e)}}),n.open("GET",e,!0),n.timeout=4e3,n.withCredentials=!0,n.send(),!0},c=function(e,t,n,o){var r=(+new Date).toString(36),a=document.location&&"https:"===document.location.protocol?"https:":"http:",c="".concat(a,"//").concat(i.endpoint,"/").concat(e,"/").concat(r,"/");for(var l in c+="?key=".concat(i.apiKey),c+="&sdk=".concat(i.sdkName,"-").concat(i.sdkVersion),c+="&ingestlyId=".concat(n),c+="&rootId=".concat(o),t)c+=d(l,t[l]);return c},d=function(e,t){return"object"===r(t)&&(t=JSON.stringify(t)),void 0!==t&&""!==t&&"{}"!==t?"&".concat(e,"=").concat(encodeURIComponent(t)):""},l=!0,u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=t}var t,n,r;return t=e,(n=[{key:"emit",value:function(e){var t=c("ingestly-ingest",e,i.deviceId,i.rootId);if("sendBeacon"in navigator&&"function"==typeof navigator.sendBeacon&&!0===l){try{l=navigator.sendBeacon(t)}catch(e){l=!1}if(!l)if("function"==typeof window[i.target].fetch&&"function"==typeof window[i.target].AbortController){var n=new AbortController,o={signal:n.signal,method:"POST",cache:"no-store",keepalive:!0};setTimeout(function(){return n.abort()},4e3),window[i.target].fetch(t,o)}else a(t)}else a(t)}},{key:"sync",value:function(e,t){var n=c("ingestly-sync",e,i.deviceId,i.rootId);if("function"==typeof window[i.target].fetch&&"function"==typeof window[i.target].AbortController){var o=new AbortController,r={signal:o.signal,method:"GET",cache:"no-store",keepalive:!0};setTimeout(function(){return o.abort()},4e3),window[i.target].fetch(n,r).then(function(e){return e.json()}).then(function(e){t.call(null,e.id)})}else a(n,function(e){t.call(null,e.id)})}}])&&o(t.prototype,n),r&&o(t,r),e}();function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var f={},p=0,m=function(){function e(t){var n,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);try{n=new CustomEvent(t.eventName)}catch(e){(n=window.parent.document.createEvent("CustomEvent")).initCustomEvent(t.eventName,!1,!1,{})}window.parent.requestAnimationFrame=window.parent.requestAnimationFrame||window.parent.mozRequestAnimationFrame||window.parent.webkitRequestAnimationFrame,function e(){if(window.parent.requestAnimationFrame(e),o)return!1;o=setTimeout(function(){window.parent.dispatchEvent(n),o=null},t.eventFrequency)}()}var t,n,o;return t=e,(n=[{key:"addListener",value:function(e,t,n,o){return e.addEventListener(t,n,o),f[p]={element:e,type:t,listener:n,capture:o},p++}},{key:"removeListener",value:function(e){if(e in f){var t=f[e];t.element.removeEventListener(t.type,t.listener,t.capture)}}}])&&s(t.prototype,n),o&&s(t,o),e}();function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var g,h,y=function(){for(var e=(+new Date).toString(36),t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n="",o=0;o<32;o++)n+=t[Math.floor(Math.random()*t.length)];return"".concat(e,"-").concat(n)},w=function(){var e,t,n,o=(e=g,t=window.parent.document.cookie||"",("; ".concat(t,";").match("; ".concat(e,"=([^Â¥S;]*)"))||[])[1]||""),r=localStorage.getItem(g)||"";return o.length>8?n=o:r.length>8?n=r:(n=h,b=!0),n},b=!1,k=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h=y(),g="".concat(t.prefix,"-id"),this.deviceId=w(),this.rootId=h,this.isNewId=b}var t,n,o;return t=e,(n=[{key:"setDeviceId",value:function(e){this.deviceId=e;try{localStorage.setItem(g,e)}catch(t){window.parent.document.cookie="".concat(g,"=").concat(e,"; Path=/; Max-Age=31536000; SameSite=Lax")}}}])&&v(t.prototype,n),o&&v(t,o),e}();function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"getPerformanceInfo",value:function(){var e=window.performance.timing,t=e.domInteractive-e.domLoading,n=e.domContentLoadedEventStart-e.domLoading,o=e.domComplete-e.domLoading;return{ptInteractive:t>=0?t:void 0,ptDcl:n>=0?n:void 0,ptComplete:o>=0?o:void 0}}},{key:"getClientInfo",value:function(e){var t,n,o=navigator.userAgent,r=screen.orientation||screen.mozOrientation||screen.msOrientation||"not-supported";return"object"===S(r)&&(r=r.type),o.match(/iPhone|iPod/g)?(n="iOS",t="Mobile"):o.match(/iPad/g)?(n="iOS",t="Tablet"):o.match(/Android/g)?o.match(/Windows Phone/g)?(n="Windows Phone",t="Mobile"):(n="Android",t=o.match(/Mobile/g)?"Mobile":"Tablet"):o.match(/Windows/g)?(n="Windows",t="Desktop"):o.match(/Mac OS X/g)?(n="Mac OS X",t="Desktop"):o.match(/Linux/g)?(n="Linux",t="Desktop"):o.match(/CrOS/g)?(n="Chrome OS",t="Desktop"):o.match(/Nintendo|PlayStation|Xbox/g)?(n="Other",t="Game"):(n="Other",t="Unknown"),{vpHeight:window[e].innerHeight,vpWidth:window[e].innerWidth,scHeight:window[e].screen.height,scWidth:window[e].screen.width,scOrientation:r,dvType:t,dvOs:n,dvPlatform:navigator.platform}}},{key:"getMediaInfo",value:function(e){return!!e&&{mdSrc:e.src,mdCurrentTime:Math.round(10*e.currentTime)/10,mdDuration:Math.round(10*e.duration)/10,mdPlayedPercent:Math.round(e.currentTime/e.duration*1e3)/10,mdAttr:{type:e.type||void 0,width:e.clientWidth||void 0,height:e.clientHeight||void 0,muted:e.muted||!1,defaultMuted:e.defaultMuted||!1,autoplay:e.autoplay||!1,playerId:e.playerId||void 0,dataset:e.dataset}}}},{key:"getVisibility",value:function(e,t){var n=0,o={};try{o=e.getBoundingClientRect(),n=e.innerText.length}catch(e){o={}}var r=window[t].innerHeight,i=window[t].document.documentElement.scrollHeight,a=window[t].document.visibilityState||"unknown",c="pageYOffset"in window[t]?window[t].pageYOffset:(window[t].document.documentElement||window[t].document.body.parentNode||window[t].document.body).scrollTop,d=c+r,l=o.height,u=o.top<=0?0:o.top,s=-1*(o.bottom-r)<=0?0:-1*(o.bottom-r),f=d,p=d/i,m=null,v=null,g=!1;return o.top>=0&&o.bottom>r&&o.top>=r?(m=null,v=null,g=!1):o.top>=0&&o.bottom>r&&o.top<r?(m=0,v=r-o.top,g=!0):o.top<0&&o.bottom>r?(v=(m=-1*o.top)+r,g=!0):o.top>=0&&o.bottom<=r?(m=0,v=l,g=!0):o.top<0&&o.bottom>=0&&o.bottom<=r?(m=l+o.top,v=l,g=!0):o.top<0&&o.bottom<0?(m=null,v=null,g=!1):g=!1,{dHeight:i,dIsVisible:a,dVisibleTop:c,dVisibleBottom:d,dScrollUntil:f,dScrollRate:p,tHeight:l,tVisibleTop:m,tVisibleBottom:v,tMarginTop:u,tMarginBottom:s,tScrollUntil:v,tScrollRate:v/l,tViewableRate:(v-m)/l,tIsInView:g,tLength:n}}},{key:"queryMatch",value:function(e,t){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data-trackable",r="button",i=[];for(3===t.nodeType&&(t=t.parentNode);t&&t!==window.parent.document;){var a=(t.matches||t.msMatchesSelector||function(){return!1}).bind(t);t.hasAttribute(o)&&i.unshift(t.getAttribute(o)),!n&&a(e)&&(r="a"===t.tagName.toLowerCase()?"link":t.tagName.toLowerCase(),n=t),t=t.parentNode}return!!(n&&i.length>0)&&{element:n,category:r,path:i.join(">")}}},{key:"mergeObj",value:function(e){for(var t={},n=0;n<e.length;n++)for(var o in e[n])"object"!==S(e[n][o])||null===e[n][o]||Array.isArray(e[n][o])?Array.isArray(e[n][o])?t[o]=t[o]?t[o].concat(e[n][o]):e[n][o]:t[o]=e[n][o]:t[o]=t[o]?this.mergeObj([t[o],e[n][o]]):e[n][o];return t}},{key:"parseUrl",value:function(e){var t,n={},o=document.createElement("a");return e&&(o.href=e,t=o.search.slice(1).split("&").reduce(function(e,t){var n=t.split("=");return e[n[0]]=n[1],e},{}),n={Protocol:o.protocol,Host:o.hostname,Port:o.port,Path:o.pathname,Search:o.search,Hash:o.hash,Query:t}),n}}])&&T(t.prototype,n),o&&T(t,o),e}();function M(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var L,A,O,C,P,N,R,x,j=new Date,E={media:[]},V=new Date,D=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataModel={},this.trackReadTargets=[]}var t,n,o;return t=e,(n=[{key:"config",value:function(e){L=e,N=new I,O=new k({prefix:L.prefix,target:L.targetWindow}),C=new u({endpoint:L.endpoint,apiKey:L.apiKey,sdkName:"JS",sdkVersion:"0.6.0",deviceId:O.deviceId,rootId:O.rootId,target:L.targetWindow}),A=L.targetWindow,R=N.parseUrl(window[A].document.location.href),x=N.parseUrl(window[A].document.referrer)}},{key:"init",value:function(e){for(var t in this.dataModel=e,R)this.dataModel["ur".concat(t)]=R[t];for(var n in x)this.dataModel["rf".concat(n)]=x[n];L.eventName&&L.eventFrequency&&void 0===P&&(P=new m({eventName:L.eventName,eventFrequency:L.eventFrequency})),L.options&&L.options.rum&&L.options.rum.enable&&("interactive"===window[A].document.readyState||"complete"===window[A].document.readyState?this.trackAction("rum","page",{}):this.trackPerformance(A)),L.options&&L.options.unload&&L.options.unload.enable&&this.trackUnload(A),L.options&&L.options.scroll&&L.options.scroll.enable&&this.trackScroll(),L.options&&L.options.read&&L.options.read.enable&&(this.trackReadTargets=[].slice.call(L.options.read.targets),this.trackRead()),L.options&&L.options.clicks&&L.options.clicks.enable&&this.trackClicks(),L.options&&L.options.media&&L.options.media.enable&&this.trackMedia()}},{key:"trackAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unknown",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new Date,r={action:e,category:t,sinceInitMs:o.getTime()-j.getTime(),sincePrevMs:o.getTime()-V.getTime()},i=N.mergeObj([this.dataModel,r,n,N.getClientInfo(A),"performance"in window[A]?N.getPerformanceInfo():{}]);V=o,O.isNewId?C.sync(i,function(e){O.setDeviceId(e),O.isNewId=!1}):(C.emit(i),O.setDeviceId(O.deviceId))}},{key:"trackPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.trackAction("view","page",e)}},{key:"trackPerformance",value:function(){var e=this;P.removeListener(E.performance),E.performance=P.addListener(window[A].document,"DOMContentLoaded",function(){e.trackAction("rum","page",{})},!1)}},{key:"trackUnload",value:function(){var e,t=this;e="onbeforeunload"in window[A]?"beforeunload":"onpagehide"in window[A]?"pagehide":"unload",P.removeListener(E.unload),E.unload=P.addListener(window[A],e,function(){t.trackAction("unload","page",{})},!1)}},{key:"trackClicks",value:function(){var e=this;P.removeListener(E.click),E.click=P.addListener(window[A].document.body,"click",function(t){var n=L.options.clicks.targetAttr||"data-trackable",o=N.queryMatch('a, button, input, [role="button"]',t.target,n),r=null;o&&(r=o.element,e.trackAction("click",o.category,{clTag:r.tagName,clId:r.id||void 0,clClass:r.className||void 0,clPath:o.path||void 0,clLink:r.href||void 0,clText:r.innerText||r.value||void 0,clAttr:r.dataset||void 0}))},!1)}},{key:"trackScroll",value:function(){var e=this,t=L.options.scroll.granularity||20,n=100/t,o=1e3*L.options.scroll.threshold||2e3,r={},i=0,a=0,c="percent";P.removeListener(E.scroll),E.scroll=P.addListener(window[A],L.eventName,function(){"hidden"!==(r=N.getVisibility(null,A)).dIsVisible&&"prerender"!==r.dIsVisible&&("percent"===L.options.scroll.unit?i=Math.floor(r.dScrollRate*n)*t:(i=r.dScrollUntil,c="pixel"),("percent"===c&&i>a&&i>=0&&i<=100||"pixel"===c&&i>a&&i>=t)&&setTimeout(function(){i>a&&(e.trackAction("scroll","page",{pgH:r.dHeight,srDepth:i,srUnit:c}),a="percent"===c?i:i+t)},o))},!1)}},{key:"trackRead",value:function(){var e=this;if(this.trackReadTargets&&0!==this.trackReadTargets.length){var t=L.options.read.granularity||20,n=100/t,o=1e3*L.options.read.threshold||2e3,r=[],i=[],a=[];P.removeListener(E.read),E.read=P.addListener(window[A],L.eventName,function(){for(var c=function(c){i[c]=i[c]||0,a[c]=a[c]||0,r[c]=N.getVisibility(e.trackReadTargets[c],A),"hidden"!==r[c].dIsVisible&&"prerender"!==r[c].dIsVisible&&r[c].tIsInView&&(i[c]=Math.floor(r[c].tScrollRate*n)*t,i[c]>a[c]&&i[c]>=0&&i[c]<=100&&setTimeout(function(){i[c]>a[c]&&e.trackReadTargets[c]&&(e.trackAction("read","content",{rdIdx:c,rdId:e.trackReadTargets[c].id||void 0,rdTxS:e.trackReadTargets[c].innerText.substring(0,12)||void 0,rdTgH:r[c].tHeight,rdTxL:r[c].tLength,rdRate:i[c],rdAttr:e.trackReadTargets[c].dataset||void 0}),100===i[c]&&e.trackReadTargets.splice(c,1),a[c]=i[c])},o))},d=0;d<e.trackReadTargets.length;d++)c(d)},!1)}}},{key:"trackMedia",value:function(){for(var e=this,t=["play","pause","ended"],n=L.options.media.heartbeat||5,o={},r=0;r<t.length;r++)P.removeListener(E.media[t[r]]),E.media[t[r]]=P.addListener(window[A].document.body,t[r],function(t){e.trackAction(t.type,t.target.tagName.toLowerCase(),N.getMediaInfo(t.target))},{capture:!0});P.removeListener(E.media.timeupdate),E.media.timeupdate=P.addListener(window[A].document,"timeupdate",function(t){if(o[t.target.src])return!1;o[t.target.src]=setTimeout(function(){!0!==t.target.paused&&!0!==t.target.ended&&e.trackAction(t.type,t.target.tagName.toLowerCase(),N.getMediaInfo(t.target)),o[t.target.src]=!1},1e3*n)},{capture:!0})}},{key:"getQueryVal",value:function(e){return R.Query[e]?R.Query[e]:""}}])&&M(t.prototype,n),o&&M(t,o),e}();window.Ingestly=new D}]);